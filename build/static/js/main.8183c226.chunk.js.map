{"version":3,"sources":["app.module.scss","components/WhiteBoard/eraserBrush.js","components/WhiteBoard/index.jsx","App.js","index.js"],"names":["module","exports","__setBgOverlayColor","fabric","StaticCanvas","prototype","___setBgOverlay","__setBgOverlay","util","object","extend","backgroundColor","undefined","overlayColor","property","color","callback","options","_this","this","cb","Rect","width","height","fill","call","colorStops","Gradient","value","loaded","type","enlivenObjects","enlivedObject","_renderBackgroundOrOverlay","ctx","v","viewportTransform","needsVpt","save","transform","render","restore","toObject","Object","erasable","getEraser","clipPath","eraser","additionalProperties","concat","groupToObject","Group","Canvas","isErasing","isDrawingMode","freeDrawingBrush","_isErasing","renderAll","contextTopDirty","_groupSelector","clearContext","contextTop","hasLostContext","renderTopLayer","canvasToDrawOn","contextContainer","renderCanvas","_chooseObjectsToRender","_render","EraserBrush","createClass","PencilBrush","_ready","_drawOverlayOnTop","initialize","canvas","callSuper","_renderBound","bind","forCanvasDrawables","hideObject","_originalOpacity","opacity","set","restoreObjectVisibility","prepareCanvasBackgroundForLayer","layer","image","get","erasablesOnLayer","prepareCanvasOverlayForLayer","renderOverlayOnTop","restoreCanvasDrawables","prepareCollectionTraversal","collection","forEachObject","obj","restoreCollectionTraversal","prepareCanvasObjectsForLayer","restoreCanvasObjectsFromLayer","prepareCanvasForLayer","restoreCanvasFromLayer","renderBottomLayer","getContext","getObjects","filter","isType","renderOverlay","_saveAndTransform","_renderOverlay","globalCompositeOperation","needsFullRender","onMouseDown","pointer","_isMainEvent","e","_prepareForDrawing","_captureDrawingPath","fire","isRendering","requestAnimFrame","_addPathToObjectEraser","path","clipObject","_obj","objects","originX","originY","boundingObjects","clone","desiredTransform","multiplyTransformMatrices","invertTransform","calcTransformMatrix","applyTransformToObject","addWithUpdate","dirty","applyEraserToCanvas","drawable","imgProp","_","colorProp","sourceImage","sourceColor","_finalizeAndAddPath","closePath","decimate","_points","decimatePoints","pathData","length","convertPointsToSVGPath","join","requestRenderAll","createPath","intersectsWithObject","setCoords","_resetShadow","currentMode","currentColor","currentWidth","group","Whiteboard","useState","setCanvas","canvasJSON","useEffect","addCanvasEventListeners","loadFromJSON","on","event","JSON","stringify","toJSON","className","styles","app","onClick","rect","top","left","objectCaching","data","console","log","add","createRect","circle","Circle","radius","cornerSize","createCircle","triangle","Triangle","createTriangle","createBackgroundImage","draw","changeToErasingMode","text","Textbox","editable","createText","onChange","target","min","max","step","parseInt","forEach","item","backgroundImage","remove","clearCanvas","canvasToJson","parse","canvasFromJson","htmlFor","id","accept","reader","FileReader","file","files","addEventListener","Image","fromURL","result","img","readAsDataURL","App","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.8183c226.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"app_app__3mk8F\",\"canvas\":\"app_canvas__1LfB-\"};","(function () {\n  var __setBgOverlayColor = fabric.StaticCanvas.prototype.__setBgOverlayColor;\n  var ___setBgOverlay = fabric.StaticCanvas.prototype.__setBgOverlay;\n  fabric.util.object.extend(fabric.StaticCanvas.prototype, {\n    backgroundColor: undefined,\n    overlayColor: undefined,\n    /**\n     * Create Rect that holds the color to support erasing\n     * patches {@link CommonMethods#_initGradient}\n     * @private\n     * @param {'bakground'|'overlay'} property\n     * @param {(String|fabric.Pattern|fabric.Rect)} color Color or pattern or rect\n     * @param {Function} callback Callback to invoke when color is set\n     * @param {Object} options\n     * @return {fabric.Canvas} instance\n     * @chainable true\n     */\n    __setBgOverlayColor: function (property, color, callback, options) {\n      var _this = this;\n      var cb = function () {\n        _this[property] = new fabric.Rect(\n          fabric.util.object.extend(\n            {\n              width: _this.width,\n              height: _this.height,\n              fill: _this[property],\n            },\n            options\n          )\n        );\n        callback && callback(_this[property]);\n      };\n\n      __setBgOverlayColor.call(this, property, color, cb);\n      //  invoke cb in case of gradient\n      //  see {@link CommonMethods#_initGradient}\n      if (color && color.colorStops && !(color instanceof fabric.Gradient)) {\n        cb();\n      }\n      return this;\n    },\n\n    /**\n     * patch serialization\n     * background/overlay properties could be objects if parsed by this mixin or could be legacy values\n     * @private\n     * @param {String} property Property to set (backgroundImage, overlayImage, backgroundColor, overlayColor)\n     * @param {(Object|String)} value Value to set\n     * @param {Object} loaded Set loaded property to true if property is set\n     * @param {Object} callback Callback function to invoke after property is set\n     */\n    __setBgOverlay: function (property, value, loaded, callback) {\n      var _this = this;\n\n      if (\n        (property === \"backgroundColor\" || property === \"overlayColor\") &&\n        value &&\n        typeof value === \"object\" &&\n        value.type === \"rect\"\n      ) {\n        fabric.util.enlivenObjects([value], function (enlivedObject) {\n          _this[property] = enlivedObject[0];\n          loaded[property] = true;\n          callback && callback();\n        });\n      } else {\n        ___setBgOverlay.call(this, property, value, loaded, callback);\n      }\n    },\n\n    /**\n     * @private\n     * @param {CanvasRenderingContext2D} ctx Context to render on\n     * @param {string} property 'background' or 'overlay'\n     */\n    _renderBackgroundOrOverlay: function (ctx, property) {\n      var fill = this[property + \"Color\"],\n        object = this[property + \"Image\"],\n        v = this.viewportTransform,\n        needsVpt = this[property + \"Vpt\"];\n      if (!fill && !object) {\n        return;\n      }\n      if (fill || object) {\n        ctx.save();\n        if (needsVpt) {\n          ctx.transform(v[0], v[1], v[2], v[3], v[4], v[5]);\n        }\n        fill && fill.render(ctx);\n        object && object.render(ctx);\n        ctx.restore();\n      }\n    },\n  });\n\n  var toObject = fabric.Object.prototype.toObject;\n  fabric.util.object.extend(fabric.Object.prototype, {\n    /**\n     * Indicates whether this object can be erased by {@link fabric.EraserBrush}\n     * @type boolean\n     * @default true\n     */\n    erasable: true,\n\n    /**\n     *\n     * @returns {fabric.Group | null}\n     */\n    getEraser: function () {\n      return this.clipPath && this.clipPath.eraser ? this.clipPath : null;\n    },\n\n    /**\n     * Returns an object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function (additionalProperties) {\n      return toObject.call(this, [\"erasable\"].concat(additionalProperties));\n    },\n  });\n\n  var groupToObject = fabric.Group.prototype.toObject;\n  fabric.util.object.extend(fabric.Group.prototype, {\n    /**\n     * Returns an object representation of an instance\n     * @param {Array} [propertiesToInclude] Any properties that you might want to additionally include in the output\n     * @return {Object} Object representation of an instance\n     */\n    toObject: function (additionalProperties) {\n      return groupToObject.call(this, [\"eraser\"].concat(additionalProperties));\n    },\n  });\n\n  fabric.util.object.extend(fabric.Canvas.prototype, {\n    /**\n     * Used by {@link #renderAll}\n     * @returns boolean\n     */\n    isErasing: function () {\n      return (\n        this.isDrawingMode &&\n        this.freeDrawingBrush &&\n        this.freeDrawingBrush.type === \"eraser\" &&\n        this.freeDrawingBrush._isErasing\n      );\n    },\n\n    /**\n     * While erasing, the brush is in charge of rendering the canvas\n     * It uses both layers to achieve diserd erasing effect\n     *\n     * @returns fabric.Canvas\n     */\n    renderAll: function () {\n      if (this.contextTopDirty && !this._groupSelector && !this.isDrawingMode) {\n        this.clearContext(this.contextTop);\n        this.contextTopDirty = false;\n      }\n      // while erasing the brush is in charge of rendering the canvas so we return\n      if (this.isErasing()) {\n        this.freeDrawingBrush._render();\n        return;\n      }\n      if (this.hasLostContext) {\n        this.renderTopLayer(this.contextTop);\n      }\n      var canvasToDrawOn = this.contextContainer;\n      this.renderCanvas(canvasToDrawOn, this._chooseObjectsToRender());\n      return this;\n    },\n  });\n\n  /**\n   * EraserBrush class\n   * Supports selective erasing meaning that only erasable objects are affected by the eraser brush.\n   * In order to support selective erasing all non erasable objects are rendered on the main/bottom ctx\n   * while the entire canvas is rendered on the top ctx.\n   * Canvas bakground/overlay image/color are handled as well.\n   * When erasing occurs, the path clips the top ctx and reveals the bottom ctx.\n   * This achieves the desired effect of seeming to erase only erasable objects.\n   * After erasing is done the created path is added to all intersected objects' `clipPath` property.\n   *\n   *\n   * @class fabric.EraserBrush\n   * @extends fabric.PencilBrush\n   */\n  fabric.EraserBrush = fabric.util.createClass(\n    fabric.PencilBrush,\n    /** @lends fabric.EraserBrush.prototype */ {\n      type: \"eraser\",\n\n      /**\n       * Indicates that the ctx is ready and rendering can begin.\n       * Used to prevent a race condition caused by {@link fabric.EraserBrush#onMouseMove} firing before {@link fabric.EraserBrush#onMouseDown} has completed\n       *\n       * @private\n       */\n      _ready: false,\n\n      /**\n       * @private\n       */\n      _drawOverlayOnTop: false,\n\n      /**\n       * @private\n       */\n      _isErasing: false,\n\n      initialize: function (canvas) {\n        this.callSuper(\"initialize\", canvas);\n        this._renderBound = this._render.bind(this);\n        this.render = this.render.bind(this);\n      },\n\n      /**\n       * @private\n       * @param {Function} callback\n       * @returns\n       */\n      forCanvasDrawables: function (callback) {\n        var _this = this;\n        callback.call(\n          _this,\n          \"background\",\n          \"backgroundImage\",\n          \"setBackgroundImage\",\n          \"backgroundColor\",\n          \"setBackgroundColor\"\n        );\n        callback.call(\n          _this,\n          \"overlay\",\n          \"overlayImage\",\n          \"setOverlayImage\",\n          \"overlayColor\",\n          \"setOverlayColor\"\n        );\n      },\n\n      /**\n       * Used to hide a drawable from the rendering process\n       * @param {fabric.Object} object\n       */\n      hideObject: function (object) {\n        if (object) {\n          object._originalOpacity = object.opacity;\n          object.set({ opacity: 0 });\n        }\n      },\n\n      /**\n       * Restores hiding an object\n       * {@link favric.EraserBrush#hideObject}\n       * @param {fabric.Object} object\n       */\n      restoreObjectVisibility: function (object) {\n        if (object && object._originalOpacity) {\n          object.set({ opacity: object._originalOpacity });\n          object._originalOpacity = undefined;\n        }\n      },\n\n      /**\n       * Drawing Logic For background drawables: (`backgroundImage`, `backgroundColor`)\n       * 1. if erasable = true:\n       *    we need to hide the drawable on the bottom ctx so when the brush is erasing it will clip the top ctx and reveal white space underneath\n       * 2. if erasable = false:\n       *    we need to draw the drawable only on the bottom ctx so the brush won't affect it\n       * @param {'bottom' | 'top' | 'overlay'} layer\n       */\n      prepareCanvasBackgroundForLayer: function (layer) {\n        if (layer === \"overlay\") {\n          return;\n        }\n        var canvas = this.canvas;\n        var image = canvas.get(\"backgroundImage\");\n        var color = canvas.get(\"backgroundColor\");\n        var erasablesOnLayer = layer === \"top\";\n        if (image && image.erasable === !erasablesOnLayer) {\n          this.hideObject(image);\n        }\n        if (color && color.erasable === !erasablesOnLayer) {\n          this.hideObject(color);\n        }\n      },\n\n      /**\n       * Drawing Logic For overlay drawables (`overlayImage`, `overlayColor`)\n       * We must draw on top ctx to be on top of visible canvas\n       * 1. if erasable = true:\n       *    we need to draw the drawable on the top ctx as a normal object\n       * 2. if erasable = false:\n       *    we need to draw the drawable on top of the brush,\n       *    this means we need to repaint for every stroke\n       *\n       * @param {'bottom' | 'top' | 'overlay'} layer\n       * @returns boolean render overlay above brush\n       */\n      prepareCanvasOverlayForLayer: function (layer) {\n        var canvas = this.canvas;\n        var image = canvas.get(\"overlayImage\");\n        var color = canvas.get(\"overlayColor\");\n        if (layer === \"bottom\") {\n          this.hideObject(image);\n          this.hideObject(color);\n          return false;\n        }\n        var erasablesOnLayer = layer === \"top\";\n        var renderOverlayOnTop =\n          (image && !image.erasable) || (color && !color.erasable);\n        if (image && image.erasable === !erasablesOnLayer) {\n          this.hideObject(image);\n        }\n        if (color && color.erasable === !erasablesOnLayer) {\n          this.hideObject(color);\n        }\n        return renderOverlayOnTop;\n      },\n\n      /**\n       * @private\n       */\n      restoreCanvasDrawables: function () {\n        var canvas = this.canvas;\n        this.restoreObjectVisibility(canvas.get(\"backgroundImage\"));\n        this.restoreObjectVisibility(canvas.get(\"backgroundColor\"));\n        this.restoreObjectVisibility(canvas.get(\"overlayImage\"));\n        this.restoreObjectVisibility(canvas.get(\"overlayColor\"));\n      },\n\n      /**\n       * @private\n       * This is designed to support erasing a group with both erasable and non-erasable objects.\n       * Iterates over collections to allow nested selective erasing.\n       * Used by {@link fabric.EraserBrush#prepareCanvasObjectsForLayer}\n       * to prepare the bottom layer by hiding erasable nested objects\n       *\n       * @param {fabric.Collection} collection\n       */\n      prepareCollectionTraversal: function (collection) {\n        var _this = this;\n        collection.forEachObject(function (obj) {\n          if (obj.forEachObject) {\n            _this.prepareCollectionTraversal(obj);\n          } else {\n            if (obj.erasable) {\n              _this.hideObject(obj);\n            }\n          }\n        });\n      },\n\n      /**\n       * @private\n       * Used by {@link fabric.EraserBrush#prepareCanvasObjectsForLayer}\n       * to reverse the action of {@link fabric.EraserBrush#prepareCollectionTraversal}\n       *\n       * @param {fabric.Collection} collection\n       */\n      restoreCollectionTraversal: function (collection) {\n        var _this = this;\n        collection.forEachObject(function (obj) {\n          if (obj.forEachObject) {\n            _this.restoreCollectionTraversal(obj);\n          } else {\n            _this.restoreObjectVisibility(obj);\n          }\n        });\n      },\n\n      /**\n       * @private\n       * This is designed to support erasing a group with both erasable and non-erasable objects.\n       *\n       * @param {'bottom' | 'top' | 'overlay'} layer\n       */\n      prepareCanvasObjectsForLayer: function (layer) {\n        if (layer !== \"bottom\") return;\n        this.prepareCollectionTraversal(this.canvas);\n      },\n\n      /**\n       * @private\n       * @param {'bottom' | 'top' | 'overlay'} layer\n       */\n      restoreCanvasObjectsFromLayer: function (layer) {\n        if (layer !== \"bottom\") return;\n        this.restoreCollectionTraversal(this.canvas);\n      },\n\n      /**\n       * @private\n       * @param {'bottom' | 'top' | 'overlay'} layer\n       * @returns boolean render overlay above brush\n       */\n      prepareCanvasForLayer: function (layer) {\n        this.prepareCanvasBackgroundForLayer(layer);\n        this.prepareCanvasObjectsForLayer(layer);\n        return this.prepareCanvasOverlayForLayer(layer);\n      },\n\n      /**\n       * @private\n       * @param {'bottom' | 'top' | 'overlay'} layer\n       */\n      restoreCanvasFromLayer: function (layer) {\n        this.restoreCanvasDrawables();\n        this.restoreCanvasObjectsFromLayer(layer);\n      },\n\n      /**\n       * Render all non-erasable objects on bottom layer with the exception of overlays to avoid being clipped by the brush.\n       * Groups are rendered for nested selective erasing, non-erasable objects are visible while erasable objects are not.\n       */\n      renderBottomLayer: function () {\n        var canvas = this.canvas;\n        this.prepareCanvasForLayer(\"bottom\");\n        canvas.renderCanvas(\n          canvas.getContext(),\n          canvas.getObjects().filter(function (obj) {\n            return !obj.erasable || obj.isType(\"group\");\n          })\n        );\n        this.restoreCanvasFromLayer(\"bottom\");\n      },\n\n      /**\n       * 1. Render all objects on top layer, erasable and non-erasable\n       *    This is important for cases such as overlapping objects, the background object erasable and the foreground object not erasable.\n       * 2. Render the brush\n       */\n      renderTopLayer: function () {\n        var canvas = this.canvas;\n        this._drawOverlayOnTop = this.prepareCanvasForLayer(\"top\");\n        canvas.renderCanvas(canvas.contextTop, canvas.getObjects());\n        this.callSuper(\"_render\");\n        this.restoreCanvasFromLayer(\"top\");\n      },\n\n      /**\n       * Render all non-erasable overlays on top of the brush so that they won't get erased\n       */\n      renderOverlay: function () {\n        this.prepareCanvasForLayer(\"overlay\");\n        var canvas = this.canvas;\n        var ctx = canvas.contextTop;\n        this._saveAndTransform(ctx);\n        canvas._renderOverlay(ctx);\n        ctx.restore();\n        this.restoreCanvasFromLayer(\"overlay\");\n      },\n\n      /**\n       * @extends @class fabric.BaseBrush\n       * @param {CanvasRenderingContext2D} ctx\n       */\n      _saveAndTransform: function (ctx) {\n        this.callSuper(\"_saveAndTransform\", ctx);\n        ctx.globalCompositeOperation = \"destination-out\";\n      },\n\n      /**\n       * We indicate {@link fabric.PencilBrush} to repaint itself if necessary\n       * @returns\n       */\n      needsFullRender: function () {\n        return this.callSuper(\"needsFullRender\") || this._drawOverlayOnTop;\n      },\n\n      /**\n       *\n       * @param {fabric.Point} pointer\n       * @param {fabric.IEvent} options\n       * @returns\n       */\n      onMouseDown: function (pointer, options) {\n        if (!this.canvas._isMainEvent(options.e)) {\n          return;\n        }\n        this._prepareForDrawing(pointer);\n        // capture coordinates immediately\n        // this allows to draw dots (when movement never occurs)\n        this._captureDrawingPath(pointer);\n\n        this._isErasing = true;\n        this.canvas.fire(\"erasing:start\");\n        this._ready = true;\n        this._render();\n      },\n\n      /**\n       * Rendering is done in 4 steps:\n       * 1. Draw all non-erasable objects on bottom ctx with the exception of overlays {@link fabric.EraserBrush#renderBottomLayer}\n       * 2. Draw all objects on top ctx including erasable drawables {@link fabric.EraserBrush#renderTopLayer}\n       * 3. Draw eraser {@link fabric.PencilBrush#_render} at {@link fabric.EraserBrush#renderTopLayer}\n       * 4. Draw non-erasable overlays {@link fabric.EraserBrush#renderOverlay}\n       *\n       * @param {fabric.Canvas} canvas\n       */\n      _render: function () {\n        if (!this._ready) {\n          return;\n        }\n        this.isRendering = 1;\n        this.renderBottomLayer();\n        this.renderTopLayer();\n        this.renderOverlay();\n        this.isRendering = 0;\n      },\n\n      /**\n       * @public\n       */\n      render: function () {\n        if (this._isErasing) {\n          if (this.isRendering) {\n            this.isRendering = fabric.util.requestAnimFrame(this._renderBound);\n          } else {\n            this._render();\n          }\n          return true;\n        }\n        return false;\n      },\n\n      /**\n       * Adds path to existing clipPath of object\n       *\n       * @param {fabric.Object} obj\n       * @param {fabric.Path} path\n       */\n      _addPathToObjectEraser: function (obj, path) {\n        var clipObject;\n        var _this = this;\n        //  object is collection, i.e group\n        if (obj.forEachObject) {\n          obj.forEachObject(function (_obj) {\n            if (_obj.erasable) {\n              _this._addPathToObjectEraser(_obj, path);\n            }\n          });\n          return;\n        }\n        if (!obj.getEraser()) {\n          var rect = new fabric.Rect({\n            width: obj.width,\n            height: obj.height,\n            clipPath: obj.clipPath,\n            originX: \"center\",\n            originY: \"center\",\n          });\n          var objects = [rect];\n          clipObject = new fabric.Group(objects, {\n            boundingObjects: objects,\n            eraser: true,\n          });\n        } else {\n          clipObject = obj.clipPath;\n        }\n\n        path.clone(function (path) {\n          path.globalCompositeOperation = \"destination-out\";\n          // http://fabricjs.com/using-transformations\n          var desiredTransform = fabric.util.multiplyTransformMatrices(\n            fabric.util.invertTransform(obj.calcTransformMatrix()),\n            path.calcTransformMatrix()\n          );\n          fabric.util.applyTransformToObject(path, desiredTransform);\n          clipObject.addWithUpdate(path);\n          obj.set({\n            clipPath: clipObject,\n            dirty: true,\n          });\n        });\n      },\n\n      /**\n       * Add the eraser path to canvas drawables' clip paths\n       *\n       * @param {fabric.Canvas} source\n       * @param {fabric.Canvas} path\n       */\n      applyEraserToCanvas: function (path) {\n        var canvas = this.canvas;\n        this.forCanvasDrawables(function (drawable, imgProp, _, colorProp) {\n          var sourceImage = canvas.get(imgProp);\n          var sourceColor = canvas.get(colorProp);\n          if (sourceImage && sourceImage.erasable) {\n            this._addPathToObjectEraser(sourceImage, path);\n          }\n          if (sourceColor && sourceColor.erasable) {\n            this._addPathToObjectEraser(sourceColor, path);\n          }\n        });\n      },\n\n      /**\n       * On mouseup after drawing the path on contextTop canvas\n       * we use the points captured to create an new fabric path object\n       * and add it to every intersected erasable object.\n       */\n      _finalizeAndAddPath: function () {\n        var ctx = this.canvas.contextTop,\n          canvas = this.canvas;\n        ctx.closePath();\n        if (this.decimate) {\n          this._points = this.decimatePoints(this._points, this.decimate);\n        }\n\n        // clear\n        canvas.clearContext(canvas.contextTop);\n        this._isErasing = false;\n\n        var pathData =\n          this._points && this._points.length > 1\n            ? this.convertPointsToSVGPath(this._points).join(\"\")\n            : \"M 0 0 Q 0 0 0 0 L 0 0\";\n        if (pathData === \"M 0 0 Q 0 0 0 0 L 0 0\") {\n          canvas.fire(\"erasing:end\");\n          // do not create 0 width/height paths, as they are\n          // rendered inconsistently across browsers\n          // Firefox 4, for example, renders a dot,\n          // whereas Chrome 10 renders nothing\n          canvas.requestRenderAll();\n          return;\n        }\n\n        var path = this.createPath(pathData);\n        canvas.fire(\"before:path:created\", { path: path });\n\n        // finalize erasing\n        this.applyEraserToCanvas(path);\n        var _this = this;\n        canvas.forEachObject(function (obj) {\n          if (obj.erasable && obj.intersectsWithObject(path)) {\n            _this._addPathToObjectEraser(obj, path);\n          }\n        });\n\n        canvas.fire(\"erasing:end\");\n\n        canvas.requestRenderAll();\n        path.setCoords();\n        this._resetShadow();\n\n        // fire event 'path' created\n        canvas.fire(\"path:created\", { path: path });\n      },\n    }\n  );\n})();\n","import React, { useState, useRef, useEffect } from 'react';\nimport { fabric } from 'fabric';\nimport './eraserBrush';\n\nimport styles from './index.module.scss';\n\nconst options = {\n  currentMode: '',\n  currentColor: '#000000',\n  currentWidth: 5,\n  group: {},\n};\n\nconst modes = {\n  pan: 'pan',\n  drawing: 'drawing',\n};\n\nconst initCanvas = () =>\n  new fabric.Canvas('canvas', {\n    height: 400,\n    width: 720,\n  });\n\nconst createRect = (canvas, options) => {\n  const rect = new fabric.Rect({\n    top: 100,\n    left: 100,\n    width: 60,\n    height: 70,\n    fill: options.currentColor,\n    objectCaching: false,\n    erasable: true,\n  });\n\n  rect.on('selected', (data) => {\n    console.log('選中了', data);\n  });\n\n  canvas.add(rect);\n  canvas.requestRenderAll();\n};\n\nconst createCircle = (canvas, options) => {\n  const circle = new fabric.Circle({\n    top: 200,\n    left: 200,\n    radius: 50,\n    fill: options.currentColor,\n    cornerSize: 7,\n    objectCaching: false,\n  });\n\n  canvas.add(circle);\n  canvas.requestRenderAll();\n};\n\nconst createTriangle = (canvas, options) => {\n  canvas.isDrawingMode = false;\n  const triangle = new fabric.Triangle({\n    top: 50,\n    left: 50,\n    width: 50,\n    height: 70,\n    fill: options.currentColor,\n    cornerSize: 7,\n    objectCaching: false,\n  });\n\n  canvas.add(triangle);\n  canvas.requestRenderAll();\n};\n\nconst createText = (canvas) => {\n  canvas.isDrawingMode = false;\n  const text = new fabric.Textbox('text', {\n    left: 100,\n    top: 100,\n    fill: options.currentColor,\n    editable: true,\n  });\n\n  canvas.add(text);\n  canvas.renderAll();\n};\n\nconst changeToErasingMode = (canvas) => {\n  canvas.freeDrawingBrush = new fabric.EraserBrush(canvas);\n  canvas.freeDrawingBrush.width = options.currentWidth;\n  canvas.isDrawingMode = true;\n};\n\nconst clearCanvas = (canvas) => {\n  canvas.getObjects().forEach((item) => {\n    if (item !== canvas.backgroundImage) {\n      canvas.remove(item);\n    }\n  });\n};\n\nconst canvasFromJson = (canvas) => {\n  const data = JSON.parse(\n    '{\"version\":\"4.3.1\",\"objects\":[{\"type\":\"circle\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":100,\"top\":100,\"width\":40,\"height\":40,\"fill\":\"rgba(255, 255, 255, 0.0)\",\"stroke\":\"#000000\",\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"radius\":20,\"startAngle\":0,\"endAngle\":6.283185307179586},{\"type\":\"text\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":253,\"top\":102,\"width\":95.55,\"height\":18.08,\"fill\":\"#000000\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":2.43,\"scaleY\":2.43,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"text\":\"Some text\",\"fontSize\":16,\"fontWeight\":\"normal\",\"fontFamily\":\"Arial\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"minWidth\":20,\"splitByGrapheme\":false,\"styles\":{}},{\"type\":\"rect\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":109,\"top\":212,\"width\":40,\"height\":40,\"fill\":\"rgba(255, 255, 255, 0.0)\",\"stroke\":\"#000000\",\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"rx\":0,\"ry\":0},{\"type\":\"image\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":499,\"top\":86,\"width\":1200,\"height\":900,\"fill\":\"rgb(0,0,0)\",\"stroke\":null,\"strokeWidth\":0,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":0.2,\"scaleY\":0.2,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"cropX\":0,\"cropY\":0,\"src\":\"https://miro.medium.com/max/1200/1*mk1-6aYaf_Bes1E3Imhc0A.jpeg\",\"crossOrigin\":null,\"filters\":[]},{\"type\":\"polyline\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":483.78,\"top\":339.22,\"width\":50.88,\"height\":50.88,\"fill\":\"white\",\"stroke\":\"black\",\"strokeWidth\":2,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":1,\"scaleY\":1,\"angle\":262.52,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"points\":[{\"x\":100,\"y\":100},{\"x\":99.11611652351681,\"y\":100.88388347648318},{\"x\":145.58058261758407,\"y\":147.34834957055045},{\"x\":142.92893218813452,\"y\":150},{\"x\":150,\"y\":150},{\"x\":150,\"y\":142.92893218813452},{\"x\":147.34834957055045,\"y\":145.58058261758407},{\"x\":100.88388347648318,\"y\":99.11611652351681},{\"x\":100,\"y\":100}]},{\"type\":\"image\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":197,\"top\":132,\"width\":1200,\"height\":900,\"fill\":\"rgb(0,0,0)\",\"stroke\":null,\"strokeWidth\":0,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":0.2,\"scaleY\":0.2,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"cropX\":0,\"cropY\":0,\"src\":\"https://miro.medium.com/max/1200/1*mk1-6aYaf_Bes1E3Imhc0A.jpeg\",\"crossOrigin\":null,\"filters\":[]}]}'\n  );\n  canvas.loadFromJSON(data);\n  canvas.requestRenderAll();\n};\n\nconst canvasToJson = (canvas) => {\n  console.log(JSON.stringify(canvas.toJSON()));\n};\n\nconst toggleMode = (mode, canvas) => {\n  if (options.currentMode === modes[mode]) {\n    options.currentMode = '';\n  } else {\n    options.currentMode = modes[mode];\n\n    if (mode === modes.drawing) {\n      canvas.isDrawingMode = true;\n    }\n  }\n};\n\nconst draw = (canvas) => {\n  canvas.freeDrawingBrush = new fabric.PencilBrush(canvas);\n  canvas.freeDrawingBrush.width = options.currentWidth;\n  canvas.isDrawingMode = true;\n};\n\nconst Whiteboard = () => {\n  const [canvas, setCanvas] = useState(null);\n  const [canvasJSON, setCanvasJSON] = useState(null);\n\n  useEffect(() => {\n    setCanvas(() => initCanvas());\n  }, []);\n\n  useEffect(() => {\n    if (canvas) {\n      addCanvasEventListeners(canvas);\n      canvas.loadFromJSON(canvasJSON);\n      canvas.renderAll();\n    }\n  }, [canvas]);\n\n  const addCanvasEventListeners = (canvas) => {\n    canvas.on('mouse:up', (event) => {\n      const data = JSON.stringify(canvas.toJSON());\n      // dispatch(canvasToJson(data));\n    });\n  };\n\n  const uploadImage = (e) => {\n    const reader = new FileReader();\n    const file = e.target.files[0];\n\n    reader.addEventListener('load', () => {\n      fabric.Image.fromURL(reader.result, (img) => {\n        canvas.add(img);\n      });\n    });\n\n    reader.readAsDataURL(file);\n  };\n\n  const changeCurrentWidth = (e) => {\n    options.currentWidth = parseInt(e.target.value);\n    canvas.freeDrawingBrush.width = parseInt(e.target.value);\n  };\n\n  const changeCurrentColor = (e) => {\n    options.currentColor = e.target.value;\n    canvas.freeDrawingBrush.color = e.target.value;\n  };\n\n  return (\n    <div className={styles.app}>\n      <button onClick={() => createRect(canvas, options)}>rectangle</button>\n      <button onClick={() => createCircle(canvas, options)}>circle</button>\n      <button onClick={() => createTriangle(canvas, options)}>triangle</button>\n      <button onClick={() => createBackgroundImage('https://i.imgur.com/MFdYlTH.png', canvas)}>\n        image\n      </button>\n      <button onClick={() => draw(canvas)}>pencil</button>\n      <button onClick={() => changeToErasingMode(canvas)}>eraser</button>\n      <button onClick={() => createText(canvas)}>text</button>\n      <input type=\"color\" onChange={changeCurrentColor} />\n      <input type=\"range\" min={1} max={20} step={1} onChange={changeCurrentWidth} />\n      <button onClick={() => clearCanvas(canvas)}>clear all</button>\n\n      <button onClick={() => canvasToJson(canvas)}>toJson</button>\n      <button onClick={() => canvasFromJson(canvas)}>fromJson</button>\n      <div>\n        <label htmlFor=\"uploadImage\">Upload Image： </label>\n        <input id=\"uploadImage\" type=\"file\" accept=\"image/*\" onChange={uploadImage} />\n      </div>\n\n      <canvas id=\"canvas\" />\n    </div>\n  );\n};\n\nexport default Whiteboard;\n","import React from 'react';\nimport Whiteboard from './components/WhiteBoard';\n\nimport styles from './app.module.scss';\n\nconst App = () => {\n  return (\n    <div className={styles.app}>\n      <Whiteboard />\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\nimport \"./index.scss\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n"],"sourceRoot":""}