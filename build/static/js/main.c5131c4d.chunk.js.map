{"version":3,"sources":["App.js","index.js","app.module.scss"],"names":["options","currentMode","currentColor","currentWidth","group","modes","pan","drawing","clearCanvas","canvas","getObjects","forEach","item","backgroundImage","remove","groupObjects","shouldGroup","objects","value","fabric","Group","add","destroy","oldGroup","requestRenderAll","App","useFabricJSEditor","editor","onReady","className","styles","app","onClick","rect","Rect","top","left","width","height","fill","objectCaching","on","data","console","log","createRect","circle","Circle","radius","cornerSize","createCircle","isDrawingMode","triangle","Triangle","createTriangle","url","Image","fromURL","img","mode","text","Textbox","editable","renderAll","createText","type","onChange","e","target","freeDrawingBrush","color","min","max","parseInt","JSON","stringify","toJSON","parse","loadFromJSON","canvasFromJson","accept","reader","FileReader","file","files","addEventListener","result","readAsDataURL","ReactDOM","render","document","getElementById","module","exports"],"mappings":"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","file":"static/js/main.c5131c4d.chunk.js","sourcesContent":["import React from \"react\";\nimport { fabric } from \"fabric\";\nimport { FabricJSCanvas, useFabricJSEditor } from \"fabricjs-react\";\n\nimport styles from \"./app.module.scss\";\n\nconst options = {\n  currentMode: \"\",\n  currentColor: \"#000000\",\n  currentWidth: 5,\n  group: {},\n};\n\nconst modes = {\n  pan: \"pan\",\n  drawing: \"drawing\",\n};\n\nconst createBackgroundImage = (url, canvas) => {\n  fabric.Image.fromURL(\n    url,\n    (img) => {\n      // img.scale(0.3);\n      canvas.add(img);\n    },\n    {\n      top: 0,\n      left: 0,\n      cornerSize: 7,\n    }\n  );\n  canvas.requestRenderAll();\n};\n\nconst createRect = (canvas, options) => {\n  const rect = new fabric.Rect({\n    top: 100,\n    left: 100,\n    width: 60,\n    height: 70,\n    fill: options.currentColor,\n    objectCaching: false,\n  });\n\n  rect.on(\"selected\", (data) => {\n    console.log(\"選中了\", data);\n  });\n\n  canvas.add(rect);\n  canvas.requestRenderAll();\n};\n\nconst createCircle = (canvas, options) => {\n  const circle = new fabric.Circle({\n    top: 200,\n    left: 200,\n    radius: 50,\n    fill: options.currentColor,\n    cornerSize: 7,\n    objectCaching: false,\n  });\n\n  canvas.add(circle);\n  canvas.requestRenderAll();\n};\n\nconst createTriangle = (canvas, options) => {\n  canvas.isDrawingMode = false;\n  const triangle = new fabric.Triangle({\n    top: 400,\n    left: 300,\n    width: 50,\n    height: 70,\n    fill: options.currentColor,\n    cornerSize: 7,\n    objectCaching: false,\n  });\n\n  canvas.add(triangle);\n  canvas.requestRenderAll();\n};\n\nconst createText = (canvas) => {\n  canvas.isDrawingMode = false;\n  const text = new fabric.Textbox(\"text\", {\n    left: 100,\n    top: 100,\n    fill: options.currentColor,\n    editable: true,\n  });\n\n  canvas.add(text);\n  canvas.renderAll();\n};\n\nconst clearCanvas = (canvas) => {\n  canvas.getObjects().forEach((item) => {\n    if (item !== canvas.backgroundImage) {\n      canvas.remove(item);\n    }\n  });\n};\n\nconst canvasFromJson = (canvas) => {\n  const data = JSON.parse(\n    '{\"version\":\"4.3.1\",\"objects\":[{\"type\":\"circle\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":100,\"top\":100,\"width\":40,\"height\":40,\"fill\":\"rgba(255, 255, 255, 0.0)\",\"stroke\":\"#000000\",\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"radius\":20,\"startAngle\":0,\"endAngle\":6.283185307179586},{\"type\":\"text\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":253,\"top\":102,\"width\":95.55,\"height\":18.08,\"fill\":\"#000000\",\"stroke\":null,\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":2.43,\"scaleY\":2.43,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"text\":\"Some text\",\"fontSize\":16,\"fontWeight\":\"normal\",\"fontFamily\":\"Arial\",\"fontStyle\":\"normal\",\"lineHeight\":1.16,\"underline\":false,\"overline\":false,\"linethrough\":false,\"textAlign\":\"left\",\"textBackgroundColor\":\"\",\"charSpacing\":0,\"minWidth\":20,\"splitByGrapheme\":false,\"styles\":{}},{\"type\":\"rect\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":109,\"top\":212,\"width\":40,\"height\":40,\"fill\":\"rgba(255, 255, 255, 0.0)\",\"stroke\":\"#000000\",\"strokeWidth\":1,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":1,\"scaleY\":1,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"rx\":0,\"ry\":0},{\"type\":\"image\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":499,\"top\":86,\"width\":1200,\"height\":900,\"fill\":\"rgb(0,0,0)\",\"stroke\":null,\"strokeWidth\":0,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":0.2,\"scaleY\":0.2,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"cropX\":0,\"cropY\":0,\"src\":\"https://miro.medium.com/max/1200/1*mk1-6aYaf_Bes1E3Imhc0A.jpeg\",\"crossOrigin\":null,\"filters\":[]},{\"type\":\"polyline\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":483.78,\"top\":339.22,\"width\":50.88,\"height\":50.88,\"fill\":\"white\",\"stroke\":\"black\",\"strokeWidth\":2,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":1,\"scaleY\":1,\"angle\":262.52,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"points\":[{\"x\":100,\"y\":100},{\"x\":99.11611652351681,\"y\":100.88388347648318},{\"x\":145.58058261758407,\"y\":147.34834957055045},{\"x\":142.92893218813452,\"y\":150},{\"x\":150,\"y\":150},{\"x\":150,\"y\":142.92893218813452},{\"x\":147.34834957055045,\"y\":145.58058261758407},{\"x\":100.88388347648318,\"y\":99.11611652351681},{\"x\":100,\"y\":100}]},{\"type\":\"image\",\"version\":\"4.3.1\",\"originX\":\"left\",\"originY\":\"top\",\"left\":197,\"top\":132,\"width\":1200,\"height\":900,\"fill\":\"rgb(0,0,0)\",\"stroke\":null,\"strokeWidth\":0,\"strokeDashArray\":null,\"strokeLineCap\":\"butt\",\"strokeDashOffset\":0,\"strokeLineJoin\":\"miter\",\"strokeUniform\":false,\"strokeMiterLimit\":4,\"scaleX\":0.2,\"scaleY\":0.2,\"angle\":0,\"flipX\":false,\"flipY\":false,\"opacity\":1,\"shadow\":null,\"visible\":true,\"backgroundColor\":\"\",\"fillRule\":\"nonzero\",\"paintFirst\":\"fill\",\"globalCompositeOperation\":\"source-over\",\"skewX\":0,\"skewY\":0,\"cropX\":0,\"cropY\":0,\"src\":\"https://miro.medium.com/max/1200/1*mk1-6aYaf_Bes1E3Imhc0A.jpeg\",\"crossOrigin\":null,\"filters\":[]}]}'\n  );\n  canvas.loadFromJSON(data);\n  canvas.requestRenderAll();\n};\n\nconst canvasToJson = (canvas) => {\n  console.log(JSON.stringify(canvas.toJSON()));\n};\n\nconst groupObjects = (canvas, options, shouldGroup) => {\n  if (shouldGroup) {\n    const objects = canvas.getObjects();\n    options.group.value = new fabric.Group(objects);\n    clearCanvas(canvas); // 先清除先前的，否則會重複出現兩組\n\n    canvas.add(options.group.value);\n  } else {\n    if (options.group.value) {\n      options.group.value.destroy();\n      const oldGroup = options.group.value.getObjects();\n      canvas.remove(options.group.value);\n      canvas.add(...oldGroup);\n      options.group.value = null;\n      canvas.requestRenderAll();\n    }\n  }\n};\n\nconst toggleMode = (mode, canvas) => {\n  if (options.currentMode === modes[mode]) {\n    options.currentMode = \"\";\n  } else {\n    options.currentMode = modes[mode];\n\n    if (mode === modes.drawing) {\n      canvas.isDrawingMode = true;\n    }\n  }\n};\n\nconst App = () => {\n  const { editor, onReady } = useFabricJSEditor();\n\n  const uploadImage = (e) => {\n    const reader = new FileReader();\n    const file = e.target.files[0];\n\n    reader.addEventListener(\"load\", () => {\n      fabric.Image.fromURL(reader.result, (img) => {\n        editor.canvas.add(img);\n      });\n    });\n\n    reader.readAsDataURL(file);\n  };\n\n  const changeCurrentWidth = (e) => {\n    options.currentWidth = e.target.value;\n    editor.canvas.freeDrawingBrush.width = parseInt(e.target.value);\n  };\n\n  const changeCurrentColor = (e) => {\n    options.currentColor = e.target.value;\n    editor.canvas.freeDrawingBrush.color = e.target.value;\n  };\n\n  return (\n    <div className={styles.app}>\n      <button onClick={() => createRect(editor.canvas, options)}>\n        rectangle\n      </button>\n      <button onClick={() => createCircle(editor.canvas, options)}>\n        circle\n      </button>\n      <button onClick={() => createTriangle(editor.canvas, options)}>\n        triangle\n      </button>\n      <button\n        onClick={() =>\n          createBackgroundImage(\n            \"https://i.imgur.com/MFdYlTH.png\",\n            editor.canvas\n          )\n        }\n      >\n        image\n      </button>\n      <button onClick={() => toggleMode(\"drawing\", editor.canvas)}>\n        pencil\n      </button>\n      <button onClick={() => createText(editor.canvas)}>text</button>\n      <input type=\"color\" onChange={changeCurrentColor} />\n      <input type=\"range\" min={1} max={20} onChange={changeCurrentWidth} />\n      <button onClick={() => clearCanvas(editor.canvas)}>clear all</button>\n      <button onClick={() => groupObjects(editor.canvas, options, true)}>\n        group all objects\n      </button>\n      <button onClick={() => groupObjects(editor.canvas, options, false)}>\n        ungroup\n      </button>\n\n      <button onClick={() => canvasToJson(editor.canvas)}>toJson</button>\n      <button onClick={() => canvasFromJson(editor.canvas)}>fromJson</button>\n      <input type=\"file\" accept=\"image/*\" onChange={uploadImage} />\n      <FabricJSCanvas className={styles.canvas} onReady={onReady} />\n    </div>\n  );\n};\n\nexport default App;\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\n\nimport App from \"./App\";\nimport \"./index.scss\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"app\":\"app_app__3mk8F\",\"canvas\":\"app_canvas__1LfB-\"};"],"sourceRoot":""}