(this["webpackJsonpreact-fabricjs-whiteboard"]=this["webpackJsonpreact-fabricjs-whiteboard"]||[]).push([[0],{23:function(e,t,n){e.exports={fileContainer:"PdfReader_fileContainer__2gJs-",pageInfo:"PdfReader_pageInfo__27lCr"}},33:function(e,t,n){e.exports={whiteboard:"Whiteboard_whiteboard__34LM6",toolbar:"Whiteboard_toolbar__34zob"}},37:function(e,t){},39:function(e,t,n){e.exports={app:"app_app__3mk8F"}},45:function(e,t,n){},50:function(e,t){},51:function(e,t){},52:function(e,t){},54:function(e,t){},55:function(e,t){},56:function(e,t){},57:function(e,t){},58:function(e,t){},61:function(e,t,n){"use strict";n.r(t);var r=n(1),o=n(38),c=n.n(o),i=n(32),u=n(14),a=n(13),s=n(35),l=n(34),f=n(23),d=n.n(f),b=n(5);l.a.GlobalWorkerOptions.workerSrc="//cdnjs.cloudflare.com/ajax/libs/pdf.js/".concat(l.a.version,"/pdf.worker.js");var j,p,m=function(e){var t=e.fileReaderInfo,n=e.updateFileReaderInfo,r=function(e){n({currentPageNumber:t.currentPageNumber+e})};return Object(b.jsxs)("div",{className:d.a.pdfReader,children:[Object(b.jsx)("div",{className:d.a.fileContainer,children:Object(b.jsx)(s.a,{className:d.a.document,file:t.file,onLoadSuccess:function(e){var t=e.numPages;n({totalPages:t})},onLoadProgress:function(e){var t=e.loaded,n=e.total;return console.log("Loading a document: "+t/n*100+"%")},children:Object(b.jsx)(s.b,{className:"import-pdf-page",onRenderSuccess:function(){var e=document.querySelector(".import-pdf-page canvas").toDataURL();n({currentPage:e})},pageNumber:t.currentPageNumber})})}),Object(b.jsxs)("div",{className:d.a.pageInfo,children:[Object(b.jsxs)("span",{children:["Page ",t.currentPageNumber," of ",t.totalPages||"--"]}),Object(b.jsx)("button",{type:"button",disabled:t.currentPageNumber<=1,onClick:function(){return r(-1)},children:"Previous"}),Object(b.jsx)("button",{type:"button",disabled:t.currentPageNumber>=t.totalPages,onClick:function(){return r(1)},children:"Next"})]})]})},g=n(40),h=n.p+"static/media/rectangle.55957e34.svg",O=n.p+"static/media/line.9af8c884.svg",v=n(33),x=n.n(v),C=null,w=!1,E={currentMode:"",currentColor:"#000000",currentWidth:5,fill:!1,group:{}},y={RECTANGLE:"RECTANGLE",TRIANGLE:"TRIANGLE",ELLIPSE:"ELLIPSE",LINE:"LINE",PENCIL:"PENCIL",ERASER:"ERASER"},P=function(e){return function(t){var n=t.e;w=!0;var r=e.getPointer(n);C=new a.fabric.Line([r.x,r.y,r.x,r.y],{strokeWidth:E.currentWidth,stroke:E.currentColor,selectable:!1}),e.add(C),e.requestRenderAll()}},R=function(e){return function(t){var n=t.e;if(w){var r=e.getPointer(n);C.set({x2:r.x,y2:r.y}),C.setCoords(),e.requestRenderAll()}}},N=function(){w=!1},A=function(e){return function(t){var n=t.e;w=!0;var r=e.getPointer(n);j=r.x,p=r.y,C=new a.fabric.Rect({stroke:E.currentColor,strokeWidth:E.currentWidth,fill:E.fill?E.currentColor:"transparent",left:j,top:p,width:0,height:0,selectable:!1}),e.add(C),C.on("mousedown",(function(t){E.currentMode===y.ERASER&&(console.log("\u522a\u9664",t),e.remove(t.target))}))}},k=function(e){return function(t){var n=t.e;if(w){var r=e.getPointer(n);r.x<j&&C.set("left",r.x),r.y<p&&C.set("top",r.y),C.set({width:Math.abs(r.x-j),height:Math.abs(r.y-p)}),C.setCoords(),e.renderAll()}}},I=function(){w=!1},L=function(e){return function(t){var n=t.e;w=!0;var r=e.getPointer(n);j=r.x,p=r.y,C=new a.fabric.Ellipse({stroke:E.currentColor,strokeWidth:E.currentWidth,fill:E.fill?E.currentColor:"transparent",left:j,top:p,cornerSize:7,objectCaching:!1,selectable:!1}),e.add(C)}},M=function(e){return function(t){var n=t.e;if(w){var r=e.getPointer(n);r.x<j&&C.set("left",r.x),r.y<p&&C.set("top",r.y),C.set({rx:Math.abs(r.x-j)/2,ry:Math.abs(r.y-p)/2}),C.setCoords(),e.renderAll()}}},S=function(){w=!1},D=function(e){return function(t){var n=t.e;w=!0,E.currentMode=y.TRIANGLE;var r=e.getPointer(n);j=r.x,p=r.y,C=new a.fabric.Triangle({stroke:E.currentColor,strokeWidth:E.currentWidth,fill:E.fill?E.currentColor:"transparent",left:j,top:p,width:0,height:0,selectable:!1}),e.add(C)}},W=function(e){return function(t){var n=t.e;if(w){var r=e.getPointer(n);r.x<j&&C.set("left",r.x),r.y<p&&C.set("top",r.y),C.set({width:Math.abs(r.x-j),height:Math.abs(r.y-p)}),C.setCoords(),e.renderAll()}}},_=function(){w=!1},T=function(){var e=Object(r.useState)(null),t=Object(u.a)(e,2),n=t[0],o=t[1],c=Object(r.useState)(null),s=Object(u.a)(c,2),l=s[0],f=(s[1],Object(r.useState)(5)),d=Object(u.a)(f,2),j=d[0],p=d[1],v=Object(r.useState)(!1),C=Object(u.a)(v,2),w=C[0],T=C[1],B=Object(r.useState)({file:"",totalPages:null,currentPageNumber:1,currentPage:""}),F=Object(u.a)(B,2),J=F[0],G=F[1],q=Object(r.useRef)(null),U=(Object(r.useRef)(null),Object(r.useRef)(null)),z=Object(r.useRef)(null);Object(r.useEffect)((function(){o((function(){return function(){var e=new a.fabric.Canvas("canvas",{height:600,width:800});return a.fabric.Object.prototype.transparentCorners=!1,a.fabric.Object.prototype.cornerStyle="circle",a.fabric.Object.prototype.borderColor="#4447A9",a.fabric.Object.prototype.cornerColor="#4447A9",a.fabric.Object.prototype.cornerSize=6,a.fabric.Object.prototype.padding=10,a.fabric.Object.prototype.borderDashArray=[5,5],e}()}))}),[]),Object(r.useEffect)((function(){if(n){var e=n.getCenter();a.fabric.Image.fromURL(J.currentPage,(function(t){t.scaleToHeight(n.height),n.setBackgroundImage(t,n.renderAll.bind(n),{top:e.top,left:e.left,originX:"center",originY:"center"}),n.renderAll()}))}}),[J.currentPage]),Object(r.useEffect)((function(){n&&(H(n),n.loadFromJSON(l),n.renderAll())}),[n]);var H=function(e){e.on("mouse:up",(function(t){JSON.stringify(e.toJSON())}))},X=function(e){G(Object(i.a)(Object(i.a)({},J),e))};return Object(b.jsxs)("div",{className:x.a.whiteboard,children:[Object(b.jsxs)("div",{className:x.a.toolbar,children:[Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){y.currentMode!==y.LINE&&(E.currentMode=y.LINE,e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.on("mouse:down",P(e)),e.on("mouse:move",R(e)),e.on("mouse:up",N),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll())}(n)},children:Object(b.jsx)("img",{src:O,alt:"line"})}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){E.currentMode!==y.RECTANGLE&&(E.currentMode=y.RECTANGLE,e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.on("mouse:down",A(e)),e.on("mouse:move",k(e)),e.on("mouse:up",I),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll())}(n)},children:Object(b.jsx)("img",{src:h,alt:"Rectangle"})}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){E.currentMode!==y.ELLIPSE&&(E.currentMode=y.ELLIPSE,e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.on("mouse:down",L(e)),e.on("mouse:move",M(e)),e.on("mouse:up",S),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll())}(n)},children:"Ellipse"}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.on("mouse:down",D(e)),e.on("mouse:move",W(e)),e.on("mouse:up",_),e.selection=!1,e.hoverCursor="auto",e.isDrawingMode=!1,e.getObjects().map((function(e){return e.set({selectable:!1})})),e.discardActiveObject().requestRenderAll()}(n)},children:"Triangle"}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){E.currentMode!==y.PENCIL&&(e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),E.currentMode=y.PENCIL,e.freeDrawingBrush=new a.fabric.PencilBrush(e),e.freeDrawingBrush.width=parseInt(E.currentWidth,10)||1,e.isDrawingMode=!0)}(n)},children:"Pencil"}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.isDrawingMode=!1;var t=new a.fabric.Textbox("text",{left:100,top:100,fill:E.currentColor,editable:!0});e.add(t),e.renderAll()}(n)},children:"Text"}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){E.currentMode="",e.isDrawingMode=!1,e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),e.getObjects().map((function(e){return e.set({selectable:!0})})),e.hoverCursor="all-scroll"}(n)},children:"Selection mode"}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){E.currentMode!==y.ERASER&&(e.off("mouse:down"),e.off("mouse:move"),e.off("mouse:up"),E.currentMode=y.ERASER,e.freeDrawingBrush=new a.fabric.EraserBrush(e),e.freeDrawingBrush.width=E.currentWidth,e.isDrawingMode=!0)}(n)},children:"Eraser"}),Object(b.jsx)("button",{type:"button",onClick:function(){return function(e){e.getObjects().forEach((function(t){t!==e.backgroundImage&&e.remove(t)}))}(n)},children:"Delete"}),Object(b.jsxs)("div",{children:[Object(b.jsx)("input",{type:"checkbox",name:"fill",id:"fill",checked:w,onChange:function(e){E.fill=e.target.checked,T((function(){return e.target.checked}))}}),Object(b.jsx)("label",{htmlFor:"fill",children:"fill"})]}),Object(b.jsx)("div",{children:Object(b.jsx)("input",{type:"color",name:"color",id:"color",onChange:function(e){E.currentColor=e.target.value,n.freeDrawingBrush.color=e.target.value}})}),Object(b.jsx)("input",{type:"range",min:1,max:20,step:1,value:j,onChange:function(e){var t=parseInt(e.target.value);E.currentWidth=t,n.freeDrawingBrush.width=t,p((function(){return t}))}}),Object(b.jsxs)("div",{className:"uploadInput",children:[Object(b.jsx)("label",{htmlFor:"uploadImage",children:"+Image"}),Object(b.jsx)("input",{ref:U,accept:"image/*",type:"file",onChange:function(e){var t=new FileReader,r=e.target.files[0];t.addEventListener("load",(function(){a.fabric.Image.fromURL(t.result,(function(e){e.scaleToHeight(n.height),n.add(e)}))})),t.readAsDataURL(r)}})]}),Object(b.jsxs)("div",{className:"uploadInput",children:[Object(b.jsx)("label",{htmlFor:"uploadPDF",children:"+PDF"}),Object(b.jsx)("input",{ref:z,accept:".pdf",type:"file",onChange:function(e){X({file:e.target.files[0],currentPageNumber:1})}})]}),Object(b.jsx)("button",{onClick:function(){return function(e){alert(JSON.stringify(e.toJSON()))}(n)},children:"To Json"}),Object(b.jsx)("button",{onClick:function(){q.current.toBlob((function(e){Object(g.saveAs)(e,"image.png")}))},children:"save as image"})]}),Object(b.jsx)("canvas",{ref:q,id:"canvas"}),Object(b.jsx)("div",{children:Object(b.jsx)(m,{fileReaderInfo:J,updateFileReaderInfo:X})})]})},B=function(){return Object(b.jsx)(T,{})},F=n(39),J=n.n(F),G=function(){return Object(b.jsx)("div",{className:J.a.app,children:Object(b.jsx)(B,{})})};n(45);c.a.render(Object(b.jsx)(G,{}),document.getElementById("root"))}},[[61,1,2]]]);